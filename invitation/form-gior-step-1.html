<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>GIOR - Reservation Form (Step 1)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'DM Sans', sans-serif; }
    .mobile-view-container{
      background-image:
        linear-gradient(to top, rgba(0,0,0,.8) 0%, rgba(0,0,0,.2) 60%),
        url('../imgs/img_gior_formresvp.jpg');
      background-size: cover; background-position: center;
    }
    .h-visual { height: 100dvh; }
    @supports not (height: 100dvh) { :root{--vh:1vh;} .h-visual{height:calc(var(--vh)*100);} }
    .safe-bottom { padding-bottom: max(16px, env(safe-area-inset-bottom)); }
    .safe-top { padding-top: max(12px, env(safe-area-inset-top)); }

    .form-element{ background:#fff;color:#333;border-radius:8px;padding:12px 16px;border:1px solid transparent;width:100%;font-size:16px;transition:border-color .2s;appearance:none; }
    .form-element:focus{ outline:none;border-color:#B08018; box-shadow:0 0 0 2px rgba(176,128,24,.3); }
    .form-element::placeholder{ color:#9CA3AF; } .form-element.invalid{ border-color:#EF4444; }
    .form-element.invalid:focus{ box-shadow:0 0 0 2px rgba(239,68,68,.3); }
    .select-wrapper{ position:relative; }
    .select-wrapper::after{ content:'▼'; font-size:12px; color:#6B7280; position:absolute; right:16px; top:50%; transform:translateY(-50%); pointer-events:none; }
    .error-message{ color:#F87171; font-size:14px; min-height:1em; margin-top:4px; }
  </style>
  <script>(function(){function setVh(){document.documentElement.style.setProperty('--vh',(window.innerHeight*0.01)+'px');}
    setVh();window.addEventListener('resize',setVh);window.addEventListener('orientationchange',setVh);}())</script>
</head>
<div class="md:max-w-[420px] md:mx-auto md:w-full md:h-full md:flex md:flex-col">

<body class="mobile-view-container h-visual flex flex-col text-white antialiased">
  <header class="safe-top px-6 flex justify-between items-center mb-6">
    <button type="button" onclick="history.back()" class="p-2 rounded-full hover:bg-white/10 transition-colors" aria-label="Go back">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
    </button>
    <img src="../imgs/logo_gior.png" alt="GIOR Logo" class="h-8 w-auto opacity-90">
  </header>

  <main class="flex-1 px-6 overflow-y-auto">
    <h1 class="text-2xl font-bold mb-6">Tell us a few details</h1>

    <form id="reservationForm" class="space-y-6" novalidate>
      <div>
        <label for="fullName" class="block text-sm font-medium mb-2">Full Name <span class="opacity-80">(required)</span></label>
        <input id="fullName" class="form-element" placeholder="Your full name" required>
        <div id="fullNameError" class="error-message"></div>
      </div>

      <div>
        <label for="phone" class="block text-sm font-medium mb-2">Phone Number <span class="opacity-80">(required)</span></label>
        <input id="phone" type="tel" class="form-element" placeholder="e.g., 081234567890" required>
        <div id="phoneError" class="error-message"></div>
      </div>

      <div>
        <label for="attendanceDate" class="block text-sm font-medium mb-2">Select your attendance date</label>
        <div class="select-wrapper">
          <select id="attendanceDate" class="form-element" required>
            <option value="">Pick a date</option>
            <option value="22-sept">22 Sept</option><option value="23-sept">23 Sept</option>
            <option value="24-sept">24 Sept</option><option value="25-sept">25 Sept</option>
            <option value="unable">Unable to Join</option>
          </select>
        </div>
        <div id="attendanceDateError" class="error-message"></div>
      </div>

      <div id="guestBlock">
        <label for="guestCount" class="block text-sm font-medium mb-2">Number of guests attending (including yourself)</label>
        <div class="select-wrapper">
          <select id="guestCount" class="form-element" required>
            <option value="">Choose 1–4 pax</option>
            <option value="1">1 pax</option><option value="2">2 pax</option>
            <option value="3">3 pax</option><option value="4">4 pax</option>
          </select>
        </div>
        <div id="guestCountError" class="error-message"></div>
      </div>
    </form>
  </main>

  <div class="mt-auto px-6 safe-bottom">
    <a href="#" id="nextBtn"
       class="w-full flex items-center justify-center bg-[#B08018] text-white text-base py-4 px-6 rounded-lg font-semibold hover:bg-[#9a6f15] transition-colors duration-300 text-center">
      NEXT
    </a>
  </div>

  <script>
    const fullNameInput = document.getElementById('fullName');
    const phoneInput = document.getElementById('phone');
    const attendanceDateSelect = document.getElementById('attendanceDate');
    const guestCountSelect = document.getElementById('guestCount');
    const guestBlock = document.getElementById('guestBlock');
    const nextBtn = document.getElementById('nextBtn');

    const fullNameError = document.getElementById('fullNameError');
    const phoneError = document.getElementById('phoneError');
    const attendanceDateError = document.getElementById('attendanceDateError');
    const guestCountError = document.getElementById('guestCountError');

    const get = (k)=>sessionStorage.getItem(k)??''; const set=(k,v)=>sessionStorage.setItem(k,v);

    function prefill(){
      if(get('fullName')) fullNameInput.value = get('fullName');
      if(get('phone')) phoneInput.value = get('phone');
      if(get('attendanceDate')) attendanceDateSelect.value = get('attendanceDate');
      if(get('guestCount')) guestCountSelect.value = get('guestCount');
      toggleGuestRequired();
    }
    document.addEventListener('DOMContentLoaded', prefill);

    function showError(el,msg,input){ el.textContent=msg; if(input) input.classList.add('invalid'); }
    function clearError(el,input){ el.textContent=''; if(input) input.classList.remove('invalid'); }

    const validateFullName=()=>{const v=fullNameInput.value.trim(); if(!v){showError(fullNameError,'Full name is required.',fullNameInput);return false;} clearError(fullNameError,fullNameInput);return true;};
    const validatePhone=()=>{let v=phoneInput.value.replace(/[^0-9]/g,''); phoneInput.value=v; if(!v){showError(phoneError,'Phone number is required.',phoneInput);return false;} if(v.length<9||v.length>14){showError(phoneError,'Phone must be 9–14 digits.',phoneInput);return false;} clearError(phoneError,phoneInput);return true;};
    const validateAttendanceDate=()=>{if(!attendanceDateSelect.value){showError(attendanceDateError,'Please pick a date.',attendanceDateSelect);return false;} clearError(attendanceDateError,attendanceDateSelect);return true;};
    const validateGuestCount=()=>{if(attendanceDateSelect.value==='unable'){clearError(guestCountError,guestCountSelect);return true;} if(!guestCountSelect.value){showError(guestCountError,'Please choose 1–4 pax.',guestCountSelect);return false;} clearError(guestCountError,guestCountSelect);return true;};

    function toggleGuestRequired(){const unable=attendanceDateSelect.value==='unable'; guestBlock.style.display=unable?'none':''; guestCountSelect.required=!unable;}

    fullNameInput.addEventListener('input',()=>{validateFullName(); set('fullName',fullNameInput.value.trim());});
    phoneInput.addEventListener('input',()=>{validatePhone(); set('phone',phoneInput.value.trim());});
    attendanceDateSelect.addEventListener('change',()=>{validateAttendanceDate(); toggleGuestRequired(); set('attendanceDate',attendanceDateSelect.value);});
    guestCountSelect.addEventListener('change',()=>{validateGuestCount(); set('guestCount',guestCountSelect.value);});

    nextBtn.addEventListener('click',(e)=>{
      e.preventDefault();
      const ok = validateFullName() & validatePhone() & validateAttendanceDate() & validateGuestCount();
      if(ok){
        set('fullName',fullNameInput.value.trim());
        set('phone',phoneInput.value.trim());
        set('attendanceDate',attendanceDateSelect.value);
        set('guestCount',guestCountSelect.value);
        if(attendanceDateSelect.value==='unable'){ window.location.href='form-gior-thankyou.html'; }
        else{ window.location.href='form-gior-step-2.html'; }
      }
    });
  </script>
</div>
</body>
</html>
